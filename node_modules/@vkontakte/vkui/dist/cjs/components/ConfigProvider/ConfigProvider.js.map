{"version":3,"sources":["../../../../src/components/ConfigProvider/ConfigProvider.tsx"],"names":["mapOldScheme","scheme","Scheme","DEPRECATED_CLIENT_LIGHT","BRIGHT_LIGHT","DEPRECATED_CLIENT_DARK","SPACE_GRAY","ConfigProvider","children","config","platform","VKCOM","document","setScheme","body","setAttribute","isMounted","current","canUseDOM","noop","removeAttribute","configContext","defaultProps","defaultConfigProviderProps"],"mappings":";;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AAOA;;AACA;;AACA;;AACA;;;;;;AASA,SAASA,YAAT,CAAsBC,MAAtB,EAAkE;AAChE,UAAQA,MAAR;AACE,SAAKC,8BAAOC,uBAAZ;AACE,aAAOD,8BAAOE,YAAd;;AACF,SAAKF,8BAAOG,sBAAZ;AACE,aAAOH,8BAAOI,UAAd;;AACF;AACE,aAAOL,MAAP;AANJ;AAQD;;AAED,IAAMM,cAAuC,GAAG,SAA1CA,cAA0C,OAA6B;AAAA,MAA1BC,QAA0B,QAA1BA,QAA0B;AAAA,MAAbC,MAAa;AAC3E,MAAMR,MAAM,GAAGQ,MAAM,CAACC,QAAP,KAAoBC,eAApB,GAA4BT,8BAAOS,KAAnC,GAA2CX,YAAY,CAACS,MAAM,CAACR,MAAR,CAAtE;;AAD2E,gBAGtD,kBAHsD;AAAA,MAGnEW,QAHmE,WAGnEA,QAHmE;;AAI3E,MAAMC,SAAS,GAAG,SAAZA,SAAY,GAAM;AACtB,QAAIZ,MAAM,KAAK,SAAf,EAA0B;AACxBW,MAAAA,QAAQ,CAACE,IAAT,CAAcC,YAAd,CAA2B,QAA3B,EAAqCd,MAArC;AACD;AACF,GAJD;;AAMA,MAAMe,SAAS,GAAG,mBAAO,KAAP,CAAlB;;AACA,MAAI,CAACA,SAAS,CAACC,OAAX,IAAsBC,cAA1B,EAAqC;AACnCL,IAAAA,SAAS;AACTG,IAAAA,SAAS,CAACC,OAAV,GAAoB,IAApB;AACD;;AACD,4DAA0B,YAAM;AAC9BJ,IAAAA,SAAS;AACT,WAAOZ,MAAM,KAAK,SAAX,GAAuBkB,WAAvB,GAA8B;AAAA,aAAMP,QAAQ,CAACE,IAAT,CAAcM,eAAd,CAA8B,QAA9B,CAAN;AAAA,KAArC;AACD,GAHD,EAGG,CAACnB,MAAD,CAHH;AAKA,MAAMoB,aAAa,GAAG,kCAAcZ,MAAd,CAAtB;AAEA,SACE,qCAAC,4CAAD,CAAuB,QAAvB;AAAgC,IAAA,KAAK,EAAEY;AAAvC,KACGb,QADH,CADF;AAKD,CA3BD,C,CA6BA;AACA;;;AACAD,cAAc,CAACe,YAAf,qBAAmCC,iDAAnC;eAEehB,c","sourcesContent":["import { FC, useRef } from 'react';\nimport { canUseDOM, useDOM } from '../../lib/dom';\nimport {\n  ConfigProviderContext,\n  ConfigProviderContextInterface,\n  Scheme,\n  AppearanceScheme,\n  defaultConfigProviderProps,\n} from './ConfigProviderContext';\nimport { VKCOM } from '../../lib/platform';\nimport { useIsomorphicLayoutEffect } from '../../lib/useIsomorphicLayoutEffect';\nimport { useObjectMemo } from '../../hooks/useObjectMemo';\nimport { noop } from '../../lib/utils';\n\nexport interface ConfigProviderProps extends ConfigProviderContextInterface {\n  /**\n   * Цветовая схема приложения\n   */\n  scheme?: AppearanceScheme;\n}\n\nfunction mapOldScheme(scheme: AppearanceScheme): AppearanceScheme {\n  switch (scheme) {\n    case Scheme.DEPRECATED_CLIENT_LIGHT:\n      return Scheme.BRIGHT_LIGHT;\n    case Scheme.DEPRECATED_CLIENT_DARK:\n      return Scheme.SPACE_GRAY;\n    default:\n      return scheme;\n  }\n}\n\nconst ConfigProvider: FC<ConfigProviderProps> = ({ children, ...config }) => {\n  const scheme = config.platform === VKCOM ? Scheme.VKCOM : mapOldScheme(config.scheme);\n\n  const { document } = useDOM();\n  const setScheme = () => {\n    if (scheme !== 'inherit') {\n      document.body.setAttribute('scheme', scheme);\n    }\n  };\n\n  const isMounted = useRef(false);\n  if (!isMounted.current && canUseDOM) {\n    setScheme();\n    isMounted.current = true;\n  }\n  useIsomorphicLayoutEffect(() => {\n    setScheme();\n    return scheme === 'inherit' ? noop : () => document.body.removeAttribute('scheme');\n  }, [scheme]);\n\n  const configContext = useObjectMemo(config);\n\n  return (\n    <ConfigProviderContext.Provider value={configContext}>\n      {children}\n    </ConfigProviderContext.Provider>\n  );\n};\n\n// Деструктуризация нужна из бага в react-docgen-typescript\n// https://github.com/styleguidist/react-docgen-typescript/issues/195\nConfigProvider.defaultProps = { ...defaultConfigProviderProps };\n\nexport default ConfigProvider;\n"],"file":"ConfigProvider.js"}